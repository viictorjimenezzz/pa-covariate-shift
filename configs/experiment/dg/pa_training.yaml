# @package _global_

defaults:
  - ./dg/train_dg_erm.yaml # same configuration as in the ERM baseline
  - /data/dg/@trainer.pa_datamodule: diagvib_PA.yaml

trainer:
  _target_: src.models.components.PA_trainer.PosteriorAgreementTrainer
  pa_optimizer:
    _target_: torch.optim.Adam
    _partial_: true
    lr: 0.001
    weight_decay: 0.0
  pa_epochs: 50
  beta0: 1.0
  pa_datamodule:
    # Mandatory values in diagvib_PA.yaml, therefore not yet overriden:
    collate_fn: ${data.dg.collate_fn}
    batch_size: ${data.dg.batch_size}
    # envs_index, envs_name and shift_ratio should also be specified, either here or via flags/.sh